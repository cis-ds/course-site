<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Functions in R</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45631879-2', 'auto');
  ga('send', 'pageview');

</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 66px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 71px;
  margin-top: -71px;
}

.section h2 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h3 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h4 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h5 {
  padding-top: 71px;
  margin-top: -71px;
}
.section h6 {
  padding-top: 71px;
  margin-top: -71px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Computing for the Social Sciences</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="faq.html">FAQ</a>
</li>
<li>
  <a href="syllabus.html">Syllabus</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Functions in R</h1>

</div>


<div id="objectives" class="section level1">
<h1>Objectives</h1>
<ul>
<li>Define functions and their purpose</li>
<li>Analyze a user-written function and explain how it works</li>
<li>Practice writing a function</li>
<li>Demonstrate conditional execution</li>
<li>Identify the difference between <code>if()</code> and <code>ifelse()</code></li>
<li>Write a <code>fizzbuzz</code> function</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
</div>
<div id="functions" class="section level1">
<h1>Functions</h1>
<p>Functions are an important tool in the computational social scientist’s toolkit. They enable you to avoid repetition and copy-and-paste and greatly increase the efficiency of your code writing.</p>
<ul>
<li><strong>They are easy to reuse</strong>. If an update to the code is necessary, you revise it in one location and the changes propogate to all over components that implement the function.</li>
<li><strong>They are self-documenting</strong>. <a href="http://r4ds.had.co.nz/functions.html#functions-are-for-humans-and-computers">Give your function a good name</a> and you will easily remember the function and its purpose.</li>
<li><strong>They are easy-ier to debug</strong>. There are fewer chances to make mistakes because the code only exists in one location. When copying and pasting, you may forget to copy an important line or fail to update a line in one location.</li>
</ul>
<p>In fact, you have used functions the entire time you have programmed in R. The only difference is that the functions were written for you. <code>tidyr</code>, <code>dplyr</code>, <code>ggplot2</code>, all of these libraries contain major functions for tidying, transforming, and visualizing data. <strong>You have the power to write your own functions.</strong> Well, if you don’t already you soon will.</p>
<blockquote>
<p>Good rule of thumb - <a href="http://r4ds.had.co.nz/functions.html#when-should-you-write-a-function">if you have copied and pasted a block of code more than twice, it is time to convert it to a function.</a></p>
</blockquote>
<div id="components-of-a-function" class="section level2">
<h2>Components of a function</h2>
<p>Functions have three key components:</p>
<ol style="list-style-type: decimal">
<li>A <strong>name</strong>. This should be informative and describe what the function does</li>
<li>The <strong>arguments</strong>, or list of inputs, to the function. They go inside the parentheses in <code>function()</code>.</li>
<li>The <strong>body</strong>. This is the block of code within <code>{}</code> that immediately follows <code>function(...)</code>, and is the code that you developed to perform the action described in the <strong>name</strong> using the <strong>arguments</strong> you provide.</li>
</ol>
</div>
<div id="the-rescale-function" class="section level2">
<h2>The <code>rescale</code> function</h2>
<p>Here is a user-generated function from <a href="http://r4ds.had.co.nz/functions.html#when-should-you-write-a-function">R for Data Science</a>. Analyze it and identify the three key components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rescale01 &lt;-<span class="st"> </span>function(x) {
  rng &lt;-<span class="st"> </span><span class="kw">range</span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
  (x -<span class="st"> </span>rng[<span class="dv">1</span>]) /<span class="st"> </span>(rng[<span class="dv">2</span>] -<span class="st"> </span>rng[<span class="dv">1</span>])
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rescale01</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">10</span>))</code></pre></div>
<pre><code>## [1] 0.0 0.5 1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rescale01</span>(<span class="kw">c</span>(-<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))</code></pre></div>
<pre><code>## [1] 0.0 0.5 1.0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rescale01</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="ot">NA</span>, <span class="dv">5</span>))</code></pre></div>
<pre><code>## [1] 0.00 0.25 0.50   NA 1.00</code></pre>
<details> <summary>Click for the solution</summary>
<p>
<ul>
<li>Name - <code>rescale01</code>
<ul>
<li>This is a function that will rescale a variable from 0 to 1</li>
</ul></li>
<li>Arguments
<ul>
<li>This function takes one argument <code>x</code> - the variable to be transformed</li>
<li>We could call the argument whatever we like, but <code>x</code> is a conventional name</li>
<li>Multiple inputs would be <code>x</code>, <code>y</code>, <code>z</code>, etc., or take on informative names such as <code>data</code>, <code>formula</code>, <code>na.rm</code>, etc.</li>
<li><strong>You should use what makes sense</strong></li>
</ul></li>
<li>Body
<ul>
<li>This takes two lines of code
<ol style="list-style-type: decimal">
<li>Calculate the range of the variable (its minimum and maximum values) and ignore missing values. Save this as an object called <code>rng</code>.</li>
<li>For each value in the variable, subtract the minimum value in the variable and divide by the difference between the maximum and minimum value. Use arthimetic notation to make sure order of operations is followed.</li>
</ol></li>
<li>By default, whatever is the last thing generated by the function is returned as the <em>output</em></li>
</ul></li>
</ul>
</p>
<p></details></p>
<p>This function can easily be reused for any numeric variable. Rather than writing out the contents of the function every time, we just use the function itself.</p>
</div>
<div id="pythagorean-theorem-function" class="section level2">
<h2>Pythagorean theorem function</h2>
<p>Analyze the following function.</p>
<ul>
<li>Identify the name, arguments, and body</li>
<li>What does it do?</li>
<li>If <code>a = 3</code> and <code>b = 4</code>, what should we expect the output to be?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pythagorean &lt;-<span class="st"> </span>function(a, b){
  hypotenuse &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a^<span class="dv">2</span> +<span class="st"> </span>b^<span class="dv">2</span>)
  <span class="kw">return</span>(hypotenuse)
}</code></pre></div>
<details> <summary>Click for the solution</summary>
<p>
<ul>
<li>Name - <code>pythagorean</code>
<ul>
<li>Calculates the length of the hypotenuse of a right triangle.</li>
</ul></li>
<li>Arguments
<ul>
<li>These are the inputs of the function. They go inside <code>function</code></li>
<li>This function takes two arguments
<ul>
<li><code>a</code> - length of one side of a right triangle</li>
<li><code>b</code> - length of another side of a right triangle</li>
</ul></li>
</ul></li>
<li>Body
<ul>
<li>Block of code within <code>{}</code> that immediately follows <code>function(...)</code></li>
<li>Here, I wrote two lines of code
<ul>
<li>The first line creates a new object <code>hypotenuse</code> which is the square root of the sum of squares of the two sides of the right triangle (also called the hypotenuse)</li>
<li>I then explicitly <code>return</code> <code>hypotenuse</code> as the output of the function. I could also have written the function as:</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pythagorean &lt;-<span class="st"> </span>function(a, b){
  hypotenuse &lt;-<span class="st"> </span><span class="kw">sqrt</span>(a^<span class="dv">2</span> +<span class="st"> </span>b^<span class="dv">2</span>)
}</code></pre></div>
<p>or even:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pythagorean &lt;-<span class="st"> </span>function(a, b){
  <span class="kw">sqrt</span>(a^<span class="dv">2</span> +<span class="st"> </span>b^<span class="dv">2</span>)
}</code></pre></div>
<p>But I wanted to explicitly identify each step of the code for others to review. Early on in your function writing career, you will want to be more explicit so future you can interpret your own code. As you practice and become more comfortable writing functions, you can be more relaxed in your coding style and documentation.</p>
</p>
<p></details></p>
</div>
<div id="how-to-use-a-function" class="section level2">
<h2>How to use a function</h2>
<p>When using functions, by default the returned object is merely printed to the screen.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pythagorean</span>(<span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<p>If you want it saved, you need to assign it to an object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(tri_c &lt;-<span class="st"> </span><span class="kw">pythagorean</span>(<span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">4</span>))</code></pre></div>
<pre><code>## [1] 5</code></pre>
<div id="objects-created-inside-functions" class="section level3">
<h3>Objects created inside functions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pythagorean</span>(<span class="dt">a =</span> <span class="dv">3</span>, <span class="dt">b =</span> <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hypotenuse</code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object &#39;hypotenuse&#39; not found</code></pre>
<p>Why does this generate an error? Why can we not see the results of <code>hypotenuse</code>? After all, it was generated by <code>pythagorean</code>, right?</p>
<div class="figure">
<img src="http://i.giphy.com/l1IY5J4Cfw8JLi40M.gif" />

</div>
<p>Objects created inside a function exist within their own <strong>environment</strong>. Typically you are working in the global environment. You can see all objects that exist in that environment in the top-right panel.</p>
<div class="figure">
<img src="images/environment.png" alt="The environment panel in RStudio" />
<p class="caption">The environment panel in RStudio</p>
</div>
<p>Objects created within a function are destroyed once the function completes its execution, unless you <code>return</code> the object as part of the output. This is why you do not see <code>hypotenuse</code> listed in the environment - it has already been destroyed.</p>
</div>
</div>
<div id="exercise-calculate-the-sum-of-squares-of-two-variables" class="section level2">
<h2>Exercise: calculate the sum of squares of two variables</h2>
<p>Write a function that calculates the sum of the squared value of two numbers. For instance, it should generate the following output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_function</span>(<span class="dv">3</span>, <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 25</code></pre>
<details> <summary>Click for the solution</summary>
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sum_of_squares &lt;-<span class="st"> </span>function(x, y){
  x^<span class="dv">2</span> +<span class="st"> </span>y^<span class="dv">2</span>
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum_of_squares</span>(<span class="dv">3</span>, <span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 25</code></pre>
<ul>
<li>Name - <code>sum_of_squares</code>
<ul>
<li>Calculates the sum of the squared value of two variables</li>
</ul></li>
<li>Arguments
<ul>
<li><code>x</code> - one number</li>
<li><code>y</code> - a second number</li>
</ul></li>
<li>Body
<ul>
<li>The first line squares <code>x</code> and <code>y</code> independently and then adds the results together</li>
</ul></li>
</ul>
<blockquote>
<p>Cool fact - this function also works with vectors of numbers</p>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>)
y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>)
<span class="kw">sum_of_squares</span>(x, y)</code></pre></div>
<pre><code>## [1]  5 25 61</code></pre>
</p>
<p></details></p>
</div>
</div>
<div id="conditional-execution" class="section level1">
<h1>Conditional execution</h1>
<p>Sometimes you only want to execute code if a condition is met. To do that, use an if-else statement.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (condition) {
  <span class="co"># code executed when condition is TRUE</span>
} else {
  <span class="co"># code executed when condition is FALSE</span>
}</code></pre></div>
<p><code>condition</code> must always evaluate to either <code>TRUE</code> or <code>FALSE</code> (<a href="block005_parsing_vectors.html#logical_vectors">remember your logical values?</a>). This is similar to <code>filter()</code>, except <code>condition</code> can only be a single value (i.e. a vector of length 1), whereas <code>filter()</code> works for entire vectors (or columns).</p>
<p>You can chain conditional statements together:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">if (this) {
  <span class="co"># do that</span>
} else if (that) {
  <span class="co"># do something else</span>
} else {
  <span class="co"># do something completely different</span>
}</code></pre></div>
<p>But this can get tedious if you need to consider many conditions. There are alternatives in R for some of these long conditional statements. For instance, if you want to convert a continuous (or numeric) variable to categories, use <code>cut()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diamonds %&gt;%
<span class="st">  </span><span class="kw">select</span>(carat) %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">carat_autobin =</span> <span class="kw">cut</span>(carat, <span class="dt">breaks =</span> <span class="dv">5</span>),
         <span class="dt">carat_manbin =</span> <span class="kw">cut</span>(carat,
                            <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">6</span>),
                            <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Medium&quot;</span>, <span class="st">&quot;Large&quot;</span>, <span class="st">&quot;Huge&quot;</span>)))</code></pre></div>
<pre><code>## # A tibble: 53,940 × 3
##    carat carat_autobin carat_manbin
##    &lt;dbl&gt;        &lt;fctr&gt;       &lt;fctr&gt;
## 1   0.23  (0.195,1.16]        Small
## 2   0.21  (0.195,1.16]        Small
## 3   0.23  (0.195,1.16]        Small
## 4   0.29  (0.195,1.16]        Small
## 5   0.31  (0.195,1.16]        Small
## 6   0.24  (0.195,1.16]        Small
## 7   0.24  (0.195,1.16]        Small
## 8   0.26  (0.195,1.16]        Small
## 9   0.22  (0.195,1.16]        Small
## 10  0.23  (0.195,1.16]        Small
## # ... with 53,930 more rows</code></pre>
<div id="if-versus-ifelse" class="section level2">
<h2><code>if</code> versus <code>ifelse()</code></h2>
<p>Because if-else conditional statements like the ones outlined above must always resolve to a single <code>TRUE</code> or <code>FALSE</code>, they cannot be used for vector operations. Consider the <code>gun_deaths</code> data and say you wanted to create a new column identifying whether or not an individual had at least a high school education.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rcfss)
<span class="kw">data</span>(<span class="st">&quot;gun_deaths&quot;</span>)

(educ &lt;-<span class="st"> </span><span class="kw">select</span>(gun_deaths, education))</code></pre></div>
<pre><code>## # A tibble: 100,798 × 1
##       education
##          &lt;fctr&gt;
## 1           BA+
## 2  Some college
## 3           BA+
## 4           BA+
## 5        HS/GED
## 6  Less than HS
## 7        HS/GED
## 8        HS/GED
## 9  Some college
## 10           NA
## # ... with 100,788 more rows</code></pre>
<p>This sounds like a classic if-else operation. For each individual, if <code>education</code> equals “Less than HS”, then the value in the new column should be “Less than HS”. Otherwise, it should be “HS+”. But what happens if we try to implement this using an if-else operation like above?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(educ_if &lt;-<span class="st"> </span>educ %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hsPlus =</span> if(education ==<span class="st"> &quot;Less than HS&quot;</span>){
    <span class="st">&quot;Less than HS&quot;</span>
  } else{
    <span class="st">&quot;HS+&quot;</span>
  }))</code></pre></div>
<pre><code>## Warning in if (structure(c(4L, 3L, 4L, 4L, 2L, 1L, 2L, 2L, 3L, NA, 3L,
## 2L, : the condition has length &gt; 1 and only the first element will be used</code></pre>
<pre><code>## # A tibble: 100,798 × 2
##       education hsPlus
##          &lt;fctr&gt;  &lt;chr&gt;
## 1           BA+    HS+
## 2  Some college    HS+
## 3           BA+    HS+
## 4           BA+    HS+
## 5        HS/GED    HS+
## 6  Less than HS    HS+
## 7        HS/GED    HS+
## 8        HS/GED    HS+
## 9  Some college    HS+
## 10           NA    HS+
## # ... with 100,788 more rows</code></pre>
<p>This did not work correctly. Because <code>if()</code> can only handle a single <code>TRUE</code>/<code>FALSE</code> value, it only checked the first row of the data frame. That row contained “BA+” for the individual, so it generated a vector of length 100798 with each value being “HS+”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">count</span>(educ_if, hsPlus)</code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   hsPlus      n
##    &lt;chr&gt;  &lt;int&gt;
## 1    HS+ 100798</code></pre>
<p>Because we in fact want to make this if-else comparison 100798 times, we should instead use <code>ifelse()</code>. This <strong>vectorizes</strong> the if-else comparison and makes a separate comparison for each row of the data frame. This allows us to correctly generate this new column.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(educ_ifelse &lt;-<span class="st"> </span>educ %&gt;%
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hsPlus =</span> <span class="kw">ifelse</span>(education ==<span class="st"> &quot;Less than HS&quot;</span>, <span class="st">&quot;Less than HS&quot;</span>, <span class="st">&quot;HS+&quot;</span>)))</code></pre></div>
<pre><code>## # A tibble: 100,798 × 2
##       education       hsPlus
##          &lt;fctr&gt;        &lt;chr&gt;
## 1           BA+          HS+
## 2  Some college          HS+
## 3           BA+          HS+
## 4           BA+          HS+
## 5        HS/GED          HS+
## 6  Less than HS Less than HS
## 7        HS/GED          HS+
## 8        HS/GED          HS+
## 9  Some college          HS+
## 10           NA         &lt;NA&gt;
## # ... with 100,788 more rows</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">count</span>(educ_ifelse, hsPlus)</code></pre></div>
<pre><code>## # A tibble: 3 × 2
##         hsPlus     n
##          &lt;chr&gt; &lt;int&gt;
## 1          HS+ 77553
## 2 Less than HS 21823
## 3         &lt;NA&gt;  1422</code></pre>
</div>
<div id="exercise-write-a-fizzbuzz-function" class="section level2">
<h2>Exercise: write a <code>fizzbuzz</code> function</h2>
<p><a href="https://en.wikipedia.org/wiki/Fizz_buzz"><strong>Fizz buzz</strong></a> is a children’s game that teaches about division. Players take turns counting incrementally, replacing any number divisible by three with the word “fizz” and any number divisible by five with the word “buzz”.</p>
<p>Likewise, a <code>fizzbuzz</code> function takes a single number as input. If the number is divisible by three, it returns “fizz”. If it’s divisible by five it returns “buzz”. If it’s divisible by three and five, it returns “fizzbuzz”. Otherwise, it returns the number.</p>
<p>The output of your function should look like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_function</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] &quot;fizz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_function</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] &quot;buzz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_function</span>(<span class="dv">15</span>)</code></pre></div>
<pre><code>## [1] &quot;fizzbuzz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">my_function</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 4</code></pre>
<div id="a-helpful-hint-about-modular-division" class="section level3">
<h3>A helpful hint about modular division</h3>
<p><code>%%</code> is modular division. It returns the remainder left over after the division, rather than a floating point number.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">5</span> /<span class="st"> </span><span class="dv">3</span></code></pre></div>
<pre><code>## [1] 1.666667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">5</span> %%<span class="st"> </span><span class="dv">3</span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<details> <summary>Click for the solution</summary>
<p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fizzbuzz &lt;-<span class="st"> </span>function(x){
  if(x %%<span class="st"> </span><span class="dv">3</span> ==<span class="st"> </span><span class="dv">0</span> &amp;&amp;<span class="st"> </span>x %%<span class="st"> </span><span class="dv">5</span> ==<span class="st"> </span><span class="dv">0</span>){
    <span class="kw">return</span>(<span class="st">&quot;fizzbuzz&quot;</span>)
  } else if(x %%<span class="st"> </span><span class="dv">3</span> ==<span class="st"> </span><span class="dv">0</span>){
    <span class="kw">return</span>(<span class="st">&quot;fizz&quot;</span>)
  } else if(x %%<span class="st"> </span><span class="dv">5</span> ==<span class="st"> </span><span class="dv">0</span>){
    <span class="kw">return</span>(<span class="st">&quot;buzz&quot;</span>)
  } else{
    <span class="kw">return</span>(x)
  }
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fizzbuzz</span>(<span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] &quot;fizz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fizzbuzz</span>(<span class="dv">5</span>)</code></pre></div>
<pre><code>## [1] &quot;buzz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fizzbuzz</span>(<span class="dv">15</span>)</code></pre></div>
<pre><code>## [1] &quot;fizzbuzz&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">fizzbuzz</span>(<span class="dv">4</span>)</code></pre></div>
<pre><code>## [1] 4</code></pre>
<ul>
<li>Name - <code>fizzbuzz</code>
<ul>
<li>Plays a single round of the Fizz Buzz game</li>
</ul></li>
<li>Arguments
<ul>
<li><code>x</code> - a number</li>
</ul></li>
<li>Body
<ul>
<li>Uses modular division and a series of if-else statements to check if <code>x</code> is evenly divisible with 3 and/or 5.</li>
<li>The first comparison to make checks if <code>x</code> is a “fizzbuzz” (evenly divisible by 3 <strong>and</strong> 5). This should be the first comparison because it needs to return “fizzbuzz”. If we had this at the end of the comparison chain, the function would prematurely return on “fizz” or “buzz”.
<ul>
<li>If <code>TRUE</code>, then print “fizzbuzz”</li>
</ul></li>
<li>If the first condition is not met, check to see if <code>x</code> is a “fizz” (divisible by 3).
<ul>
<li>If <code>TRUE</code>, then print “fizz”</li>
</ul></li>
<li>If the first two conditions are not met, check to see if <code>x</code> is a “buzz” (divisible by 5).
<ul>
<li>If <code>TRUE</code>, then print “buzz”</li>
</ul></li>
<li>If the first three conditions are all <code>FALSE</code>, then print the original number <code>x</code>.
</p>
</details></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="session-info" class="section level1 toc-ignore">
<h1>Session Info</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">session_info</span>()</code></pre></div>
<pre><code>## Session info --------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.3.2 (2016-10-31)
##  system   x86_64, darwin13.4.0        
##  ui       RStudio (1.0.136)           
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  tz       America/Chicago             
##  date     2017-02-22</code></pre>
<pre><code>## Packages ------------------------------------------------------------------</code></pre>
<pre><code>##  package        * version    date       source                        
##  assertthat       0.1        2013-12-06 CRAN (R 3.3.0)                
##  backports        1.0.5      2017-01-18 CRAN (R 3.3.2)                
##  base64enc        0.1-3      2015-07-28 CRAN (R 3.3.0)                
##  bigrquery      * 0.3.0      2016-06-28 CRAN (R 3.3.0)                
##  bitops           1.0-6      2013-08-17 CRAN (R 3.3.0)                
##  boot           * 1.3-18     2016-02-23 CRAN (R 3.3.2)                
##  broom          * 0.4.2      2017-02-13 CRAN (R 3.3.2)                
##  car              2.1-4      2016-12-02 CRAN (R 3.3.2)                
##  caret          * 6.0-73     2016-11-10 CRAN (R 3.3.2)                
##  codetools        0.2-15     2016-10-05 CRAN (R 3.3.2)                
##  colorspace       1.3-2      2016-12-14 CRAN (R 3.3.2)                
##  curl           * 2.3        2016-11-24 CRAN (R 3.3.2)                
##  DBI              0.5-1      2016-09-10 CRAN (R 3.3.0)                
##  devtools         1.12.0     2016-06-24 CRAN (R 3.3.0)                
##  digest           0.6.12     2017-01-27 CRAN (R 3.3.2)                
##  dplyr          * 0.5.0      2016-06-24 CRAN (R 3.3.0)                
##  evaluate         0.10       2016-10-11 CRAN (R 3.3.0)                
##  forcats        * 0.2.0      2017-01-23 CRAN (R 3.3.2)                
##  foreach        * 1.4.3      2015-10-13 CRAN (R 3.3.0)                
##  foreign          0.8-67     2016-09-13 CRAN (R 3.3.2)                
##  gam            * 1.14       2016-09-10 CRAN (R 3.3.0)                
##  gapminder      * 0.2.0      2015-12-31 CRAN (R 3.3.0)                
##  geosphere        1.5-5      2016-06-15 CRAN (R 3.3.0)                
##  ggmap          * 2.7        2016-12-07 Github (dkahle/ggmap@c6b7579) 
##  ggplot2        * 2.2.1      2016-12-30 CRAN (R 3.3.2)                
##  ggrepel        * 0.6.5      2016-11-24 CRAN (R 3.3.2)                
##  ggstance       * 0.3        2016-11-16 CRAN (R 3.3.2)                
##  gtable           0.2.0      2016-02-26 CRAN (R 3.3.0)                
##  haven          * 1.0.0      2016-09-23 cran (@1.0.0)                 
##  here           * 0.0-6      2017-02-04 Github (krlmlr/here@007bfd9)  
##  hexbin         * 1.27.1     2015-08-19 CRAN (R 3.3.0)                
##  highr            0.6        2016-05-09 CRAN (R 3.3.0)                
##  hms              0.3        2016-11-22 CRAN (R 3.3.2)                
##  htmltools        0.3.5      2016-03-21 CRAN (R 3.3.0)                
##  htmlwidgets      0.8        2016-11-09 CRAN (R 3.3.1)                
##  httpuv           1.3.3      2015-08-04 CRAN (R 3.3.0)                
##  httr           * 1.2.1      2016-07-03 CRAN (R 3.3.0)                
##  ISLR           * 1.0        2013-06-11 CRAN (R 3.3.0)                
##  iterators        1.0.8      2015-10-13 CRAN (R 3.3.0)                
##  janeaustenr      0.1.4      2016-10-26 CRAN (R 3.3.0)                
##  jpeg             0.1-8      2014-01-23 cran (@0.1-8)                 
##  jsonlite       * 1.2        2016-12-31 CRAN (R 3.3.2)                
##  knitr          * 1.15.1     2016-11-22 cran (@1.15.1)                
##  labeling         0.3        2014-08-23 CRAN (R 3.3.0)                
##  lattice        * 0.20-34    2016-09-06 CRAN (R 3.3.2)                
##  lazyeval         0.2.0      2016-06-12 CRAN (R 3.3.0)                
##  lme4             1.1-12     2016-04-16 cran (@1.1-12)                
##  lubridate      * 1.6.0      2016-09-13 CRAN (R 3.3.0)                
##  lvplot         * 0.2.0.9000 2017-01-06 Github (hadley/lvplot@8ce61c7)
##  magrittr         1.5        2014-11-22 CRAN (R 3.3.0)                
##  mapproj          1.2-4      2015-08-03 CRAN (R 3.3.0)                
##  maps           * 3.1.1      2016-07-27 cran (@3.1.1)                 
##  MASS             7.3-45     2016-04-21 CRAN (R 3.3.2)                
##  Matrix           1.2-8      2017-01-20 CRAN (R 3.3.2)                
##  MatrixModels   * 0.4-1      2015-08-22 CRAN (R 3.3.0)                
##  memoise          1.0.0      2016-01-29 CRAN (R 3.3.0)                
##  mgcv             1.8-17     2017-02-08 CRAN (R 3.3.2)                
##  microbenchmark * 1.4-2.1    2015-11-25 CRAN (R 3.3.0)                
##  mime             0.5        2016-07-07 CRAN (R 3.3.0)                
##  minqa            1.2.4      2014-10-09 cran (@1.2.4)                 
##  mnormt           1.5-5      2016-10-15 CRAN (R 3.3.0)                
##  ModelMetrics     1.1.0      2016-08-26 CRAN (R 3.3.0)                
##  modelr         * 0.1.0      2016-08-31 CRAN (R 3.3.0)                
##  modeltools       0.2-21     2013-09-02 CRAN (R 3.3.0)                
##  munsell          0.4.3      2016-02-13 CRAN (R 3.3.0)                
##  nlme             3.1-131    2017-02-06 CRAN (R 3.3.2)                
##  nloptr           1.0.4      2014-08-04 cran (@1.0.4)                 
##  NLP              0.1-9      2016-02-18 CRAN (R 3.3.0)                
##  nnet           * 7.3-12     2016-02-02 CRAN (R 3.3.2)                
##  nycflights13   * 0.2.2      2017-01-27 CRAN (R 3.3.2)                
##  pbkrtest         0.4-6      2016-01-27 CRAN (R 3.3.0)                
##  plyr             1.8.4      2016-06-08 CRAN (R 3.3.0)                
##  png              0.1-7      2013-12-03 cran (@0.1-7)                 
##  pROC           * 1.9.1      2017-02-05 CRAN (R 3.3.2)                
##  profvis        * 0.3.3      2017-01-14 CRAN (R 3.3.2)                
##  proto            1.0.0      2016-10-29 CRAN (R 3.3.0)                
##  psych            1.6.12     2017-01-08 CRAN (R 3.3.2)                
##  purrr          * 0.2.2      2016-06-18 CRAN (R 3.3.0)                
##  quantreg       * 5.29       2016-09-04 CRAN (R 3.3.0)                
##  R6               2.2.0      2016-10-05 CRAN (R 3.3.0)                
##  randomForest   * 4.6-12     2015-10-07 CRAN (R 3.3.0)                
##  rcfss          * 0.1.3      2017-02-16 local                         
##  Rcpp             0.12.9     2017-01-14 CRAN (R 3.3.2)                
##  readr          * 1.0.0      2016-08-03 CRAN (R 3.3.0)                
##  readxl         * 0.1.1      2016-03-28 CRAN (R 3.3.0)                
##  rebird         * 0.3.0      2016-03-23 CRAN (R 3.3.0)                
##  reshape2         1.4.2      2016-10-22 CRAN (R 3.3.0)                
##  RgoogleMaps      1.4.1      2016-09-18 cran (@1.4.1)                 
##  rjson            0.2.15     2014-11-03 cran (@0.2.15)                
##  rmarkdown        1.3        2016-12-21 CRAN (R 3.3.2)                
##  rprojroot        1.2        2017-01-16 CRAN (R 3.3.2)                
##  rsconnect        0.7        2016-12-21 CRAN (R 3.3.2)                
##  RSQLite        * 1.1-2      2017-01-08 CRAN (R 3.3.2)                
##  rstudioapi       0.6        2016-06-27 CRAN (R 3.3.0)                
##  rvest          * 0.3.2      2016-06-17 CRAN (R 3.3.0)                
##  scales         * 0.4.1      2016-11-09 CRAN (R 3.3.1)                
##  shiny          * 1.0.0      2017-01-12 CRAN (R 3.3.2)                
##  slam             0.1-40     2016-12-01 CRAN (R 3.3.2)                
##  SnowballC        0.5.1      2014-08-09 cran (@0.5.1)                 
##  sp               1.2-4      2016-12-22 CRAN (R 3.3.2)                
##  sparklyr       * 0.5.2      2017-02-16 CRAN (R 3.3.2)                
##  SparseM        * 1.74       2016-11-10 CRAN (R 3.3.2)                
##  stringi          1.1.2      2016-10-01 CRAN (R 3.3.0)                
##  stringr        * 1.1.0      2016-08-19 cran (@1.1.0)                 
##  tibble         * 1.2        2016-08-26 cran (@1.2)                   
##  tidyr          * 0.6.1      2017-01-10 CRAN (R 3.3.2)                
##  tidytext       * 0.1.2      2016-10-28 CRAN (R 3.3.0)                
##  tidyverse      * 1.1.1      2017-01-27 CRAN (R 3.3.2)                
##  titanic        * 0.1.0      2015-08-31 CRAN (R 3.3.0)                
##  tm               0.6-2      2015-07-03 CRAN (R 3.3.0)                
##  tokenizers       0.1.4      2016-08-29 CRAN (R 3.3.0)                
##  topicmodels    * 0.2-4      2016-05-23 CRAN (R 3.3.0)                
##  tree           * 1.0-37     2016-01-21 CRAN (R 3.3.0)                
##  withr            1.0.2      2016-06-20 CRAN (R 3.3.0)                
##  XML            * 3.98-1.5   2016-11-10 CRAN (R 3.3.2)                
##  xml2           * 1.1.1      2017-01-24 CRAN (R 3.3.2)                
##  xtable           1.8-2      2016-02-05 CRAN (R 3.3.0)                
##  yaml             2.1.14     2016-11-12 cran (@2.1.14)</code></pre>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Notice that is also preserves missing values in the new column. Remember, <a href="http://r4ds.had.co.nz/transform.html#missing-values">any operation performed on a missing value will itself become a missing value.</a><a href="#fnref1">↩</a></p></li>
</ol>
</div>

<p>This work is licensed under the  <a href="http://creativecommons.org/licenses/by-nc/4.0/">CC BY-NC 4.0 Creative Commons License</a>.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
